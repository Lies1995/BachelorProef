\section{Methode} % (fold)
\label{sec:methode}
   \begin{figure*}[h!]
		\centering
		\includegraphics[width=\textwidth]{gfx/Scat.png}
		\caption{Caption here}
	\label{fig:AbsEnScat}
\end{figure*} 
 
In voorgaande paragraaf is een oplossing voor de bioheat vergelijking besproken voor zowel een continu als gepulst stimulatie protocol. Deze benaderde oplossing wordt nu gebruikt om een voorspelling te doen voor de temperatuursstijging. Hiervoor is zowel informatie nodig over de de structuur van het weefsel als over de thermische eigenschappen. De simulaties zullen gedaan worden voor de hippocampus van de rat (zie figuur \ref{fig:ratbrein}). De weefsel eigenschappen zoals $\mu_a$ en $\mu_s$ zijn golflengte afhankelijk zoals duidelijk is uit figuur \ref{fig:AbsEnScat}. De grote piek voor de absorptieco\"effici\"ent bij $\approx 560nm$ komt door Hemoglobine. De thermische parameters voor de hippocampus staan in tabel \ref{tab:thermEig}. De fouten op de thermische eigenschappen kunnen verwaarloosd worden in vergelijking met de fouten op de weefsel parameters.
\begin{table}[h!]
	\caption{Thermische eigenschappen van rat hippocampus}
	\label{tab:thermEig}
	\centering

	\begin{tabular}{l|c}
	\hline
	\hline
	\textbf{Parameter} & \textbf{Waarde}\\
	\hline
	Dichtheid $\rho$	 &  $1040 \frac{kg}{m^3}$ \\
	Warmtecapaciteit $c$ & $3650 \frac{mJ}{g\cdot K}$\\
	Thermische conductiviteit $k$ & $0.530 \frac{W}{m\cdot K}$\\
	\hline

	\hline
	\end{tabular}
\end{table}
Vervolgens moet ook de lichtverdeling $\phi(r,z)$ bepaald worden. De lichtverdeling is een parameter die aangeeft hoe de energie van de invallende fotonen zich verdeeld over het weefsel. Om meer precies te zijn, het geeft in elk punt de verandering van de energie per eenheid van oppervlakte, per eenheid van tijd. De lichtverdeling hangt af van zowel de weefsel eigenschappen (absorptieco\"efficient $\mu_a$, verstrooingsco\"fficient $\mu_s$,brekingsindex n , anisotropie factor $g$ ) als van de laserbeam eigenschappen (golflengte, numerieke apertuur $NA$, diameter $d$). Om $\phi(r,z)$ te modelleren kan de verdeling van de energie over het weefsel gezien worden als een \emph{random walk} van fotonen (zie figuur \ref{fig:MCML}). Het principe wordt uitgelegd aan de hand van een simpel voorbeeld, het zenden van 1 foton doorheen het weefsel. Wanneer een foton het oppervlak van het weefsel bereikt, wordt het opgenomen door een molecule. Dat molecule wordt ge\"exciteerd en door conductie effecten wordt een deel van die energie doorgegeven aan omliggende moleculen. Dit gaat zo door tot de thermische energie niet meer kan doorgegeven worden. Dit proces kan ook gezien worden als \'e\'en foton met een bepaald gewicht/energie die een random walk uitvoert en na elke stap een deel van zijn energie verliest. Hoeveel energie hij verliest en de geprefereede staprichting wordt random gekozen maar is be\"invloed door de weefsel parameters. Het foton blijft wandelen totdat zijn gewicht onder een bepaalde drempel is gekomen, dan stopt de simulatie voor dat foton. Wanneer dit herhaald wordt voor $1$ miljoen fotonen kan men een duidelijk beeld krijgen van waar de energie zal opstapelen. Aan de hand van een statistisch wiskundig protocol kan vervolgens de fotonverdeling omgezet worden naar kwantitatieve gegevens voor $\phi(r,z)$\cite{MCML}. 
\begin{figure}[tb]
	\centering
	\includegraphics[width=8cm]{gfx/MCML.png}
	\caption{Caption here}
	\label{fig:MCML}
\end{figure}

Een programma geschreven door Ph. D studenten van de universiteit van Texas \emph{Lihong Wang en Steven L. Jacques} doet dergelijke monte-carlo simulaties en geeft uiteindelijk lichtverdeling voor het gewenst gebied. Voor meer details wordt verwezen naar de handleiding \cite{MCML}. De gebruikte brekingsindex is $1.4$ en de anisotropie factor voor de hippocampus wordt genomen als $0.88$. Opnieuw kunnen de fouten op deze parameters verwaarloosd worden in vergelijking met de fouten op de absorptie en scattering co\"effici\"ent. 

Om de temperatuursveranderingen te moddelleren volgens de benaderende oplossing besproken in paragraaf \ref{sec:theoretische_achtergrond} werd een matlab code geschreven, zowel voor de continue als voor de gepulste stimulatie protocols, zie hiervoor de bijlage. 
%#TODO: code toelichten, afhankelijk van hoevel we al hebben
%STUK OVER GEPULSTE STIMULATIE
\footnotesize
\begin{equation}
\Delta T(t) = \left\{\begin{array}{l l} 
\Delta T_1(t) & \text{ voor }0<t<t_L  \\
\Delta T_2(t) & \text{ voor }t_L<t<F \\ 
\Delta T_3(t) & \text{ voor }F<t<F+t_L \\
\Delta T_4(t) & \text{ voor }F+t_L<t<2F\\
\Delta T_5(t) & \text{ voor }2F<t<2F+t_L \\
\ldots
\end{array}
\label{eq:sompuls}
\end{equation}
Met
\begin{equation*} 
\begin{array}{l}
\Delta T_1(t)= \Delta T_s(t) \\
\Delta T_2(t)= \Delta T_d(t-t_L) \\
\Delta T_3(t)= \Delta T_d(t-t_L) + \Delta T_s(t-F) \\
\Delta T_4(t)= \Delta T_d(t-t_L) + \Delta T_d(t-F-t_L)\\
\Delta T_5(t)= \Delta T_d(t-t_L) + \Delta T_d(t-F-t_L) + \Delta T_s(t-2F)
\end{array}
\end{equation*}
\normalsize
Waarbij $t_L$ de lengte van een puls is, $F$ de tijd tussen twee pulsen en $T_s(t)$ en $T_d(t)$ stijgende en dalende exponentiele functies zijn, respectievelijk gegeven door: 
\begin{equation}
\Delta T_s(t) = \frac{\tau \mu_a \phi (z,r)}{\rho c} (1-e^{-\frac{t}{\tau}})
\end{equation}
\begin{equation}
\Delta T_d(t) = \frac{\tau \mu_a \phi (z,r)}{\rho c} (1-e^{-\frac{t_L}{\tau}}) e^{-\frac{t}{\tau}}
\end{equation}
